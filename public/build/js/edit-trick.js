(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["js/edit-trick"],{

/***/ "./assets/js/edit-trick.js":
/*!*********************************!*\
  !*** ./assets/js/edit-trick.js ***!
  \*********************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(/*! core-js/modules/es.array.for-each */ "./node_modules/core-js/modules/es.array.for-each.js");

__webpack_require__(/*! core-js/modules/es.regexp.exec */ "./node_modules/core-js/modules/es.regexp.exec.js");

__webpack_require__(/*! core-js/modules/es.string.replace */ "./node_modules/core-js/modules/es.string.replace.js");

__webpack_require__(/*! core-js/modules/web.dom-collections.for-each */ "./node_modules/core-js/modules/web.dom-collections.for-each.js");

(function () {
  var containerPicture = document.getElementById('trick_pictures');
  var containerVideo = document.getElementById('trick_videos');
  var indexPicture = containerPicture.querySelectorAll('.edit-trick-content-form-row').length;
  var indexVideo = containerVideo.querySelectorAll('.edit-trick-content-form-row').length;

  if (indexPicture == 0) {
    addPictureForm(containerPicture);
  }

  if (indexVideo == 0) {
    addVideoForm(containerVideo);
  }

  var createModalPicture = function createModalPicture() {
    var btn = '<button type="button" class="js-modal-close">X</button>';
    var formRow = containerPicture.querySelectorAll('.edit-trick-content-form-row');
    var elModal = document.querySelectorAll('.js-modal-picture');
    var modalWrapper = containerPicture.querySelectorAll('.modal-none');

    for (var i = 0; i < formRow.length; i++) {
      formRow[i].classList.add('modal');
      formRow[i].setAttribute("id", "modal-picture-" + i);
      formRow[i].setAttribute("aria-hidden", "true");
      formRow[i].setAttribute("role", "dialog");
      formRow[i].setAttribute("aria-modal", "false");
    }

    for (var _i = 0; _i < modalWrapper.length; _i++) {
      modalWrapper[_i].insertAdjacentHTML('afterbegin', btn);

      modalWrapper[_i].className = 'modal-wrapper js-modal-stop';
    }

    for (var _i2 = 0; _i2 < elModal.length; _i2++) {
      elModal[_i2].setAttribute("href", "#modal-picture-" + _i2);
    }
  };

  var createModalVideo = function createModalVideo() {
    var btn = '<button type="button" class="js-modal-close">X</button>';
    var formRow = containerVideo.querySelectorAll('.edit-trick-content-form-row');
    var elModal = document.querySelectorAll('.js-modal-video');
    var modalWrapper = containerVideo.querySelectorAll('.modal-none');

    for (var i = 0; i < formRow.length; i++) {
      formRow[i].classList.add('modal');
      formRow[i].setAttribute("id", "modal-video-" + i);
      formRow[i].setAttribute("aria-hidden", "true");
      formRow[i].setAttribute("role", "dialog");
      formRow[i].setAttribute("aria-modal", "false");
    }

    for (var _i3 = 0; _i3 < modalWrapper.length; _i3++) {
      modalWrapper[_i3].insertAdjacentHTML('afterbegin', btn);

      modalWrapper[_i3].className = 'modal-wrapper js-modal-stop';
    }

    for (var _i4 = 0; _i4 < elModal.length; _i4++) {
      elModal[_i4].setAttribute("href", "#modal-video-" + _i4);
    }
  };

  createModalPicture();
  createModalVideo();
  document.querySelector('.btn-add-picture').addEventListener('click', function (event) {
    event.preventDefault();
    addPictureForm(containerPicture);
  });
  document.querySelector('.btn-add-video').addEventListener('click', function (event) {
    event.preventDefault();
    addVideoForm(containerVideo);
  });

  function addRemoveBtn() {
    document.querySelectorAll('button.btn-delete-picture.fas.fa-trash-alt').forEach(function (element) {
      element.addEventListener('click', function (event) {
        event.preventDefault();
        this.parentNode.parentNode.remove();
      });
    });
    document.querySelectorAll('button.btn-delete-video.fas.fa-trash-alt').forEach(function (element) {
      element.addEventListener('click', function (event) {
        event.preventDefault();
        this.parentNode.parentNode.remove();
      });
    });
  }

  function addPictureForm(containerPicture) {
    var prototypePicture = containerPicture.getAttribute('data-prototype');
    var templatePicture = prototypePicture.replace(/__name__/g, indexPicture);
    containerPicture.insertAdjacentHTML('beforeend', templatePicture);
    indexPicture++;
    addRemoveBtn();
  }

  function addVideoForm(containerVideo) {
    var prototypeVideo = containerVideo.getAttribute('data-prototype');
    var templateVideo = prototypeVideo.replace(/__name__/g, indexVideo);
    containerVideo.insertAdjacentHTML('beforeend', templateVideo);
    indexVideo++;
    addRemoveBtn();
  }

  var modal = null;

  var openModal = function openModal(event) {
    event.preventDefault();
    var target = document.querySelector(event.target.getAttribute("href"));
    target.querySelector('.fas.fa-trash-alt').style.display = "none";
    target.style.display = "block";
    target.removeAttribute("aria-hidden");
    target.setAttribute("aria-modal", "true");
    modal = target;
    modal.addEventListener('click', closeModal);
    modal.querySelector('.js-modal-close').addEventListener('click', closeModal);
    modal.querySelector('.js-modal-stop').addEventListener('click', stopPropagation);
  };

  var closeModal = function closeModal(event) {
    if (modal === null) {
      return;
    }

    event.preventDefault();
    modal.style.display = "none";
    modal.setAttribute("aria-hidden", "true");
    modal.removeAttribute("aria-modal");
    modal.removeEventListener('click', closeModal);
    modal.querySelector('.js-modal-close').removeEventListener('click', closeModal);
    modal.querySelector('.js-modal-stop').removeEventListener('click', stopPropagation);
    modal = null;
  };

  var stopPropagation = function stopPropagation(event) {
    event.stopPropagation();
  };

  document.querySelectorAll('.js-modal-picture').forEach(function (a) {
    a.addEventListener('click', openModal);
  });
  document.querySelectorAll('.js-modal-video').forEach(function (a) {
    a.addEventListener('click', openModal);
  });
  var btnDeletePicture = document.querySelectorAll('.btn-delete-picture.fas.fa-trash-alt');

  for (var i = 0; i < btnDeletePicture.length; i++) {
    btnDeletePicture[i].setAttribute("href", "#modal-picture-" + i);
  }

  var btnDeleteVideo = document.querySelectorAll('.btn-delete-video.fas.fa-trash-alt');

  for (var _i5 = 0; _i5 < btnDeleteVideo.length; _i5++) {
    btnDeleteVideo[_i5].setAttribute("href", "#modal-video-" + _i5);
  }

  btnDeleteVideo.forEach(function (element) {
    element.addEventListener('click', function (event) {
      var target = document.querySelector(event.target.getAttribute("href"));
      event.preventDefault();

      if (target) {
        target.remove();
      }

      this.parentNode.parentNode.remove();
    });
  });
  btnDeletePicture.forEach(function (element) {
    element.addEventListener('click', function (event) {
      var target = document.querySelector(event.target.getAttribute("href"));
      event.preventDefault();

      if (target) {
        target.remove();
      }

      this.parentNode.parentNode.remove();
    });
  });
})();

/***/ })

},[["./assets/js/edit-trick.js","runtime","vendors~js/add-trick~js/edit-trick"]]]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hc3NldHMvanMvZWRpdC10cmljay5qcyJdLCJuYW1lcyI6WyJjb250YWluZXJQaWN0dXJlIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRhaW5lclZpZGVvIiwiaW5kZXhQaWN0dXJlIiwicXVlcnlTZWxlY3RvckFsbCIsImxlbmd0aCIsImluZGV4VmlkZW8iLCJhZGRQaWN0dXJlRm9ybSIsImFkZFZpZGVvRm9ybSIsImNyZWF0ZU1vZGFsUGljdHVyZSIsImJ0biIsImZvcm1Sb3ciLCJlbE1vZGFsIiwibW9kYWxXcmFwcGVyIiwiaSIsImNsYXNzTGlzdCIsImFkZCIsInNldEF0dHJpYnV0ZSIsImluc2VydEFkamFjZW50SFRNTCIsImNsYXNzTmFtZSIsImNyZWF0ZU1vZGFsVmlkZW8iLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJhZGRSZW1vdmVCdG4iLCJmb3JFYWNoIiwiZWxlbWVudCIsInBhcmVudE5vZGUiLCJyZW1vdmUiLCJwcm90b3R5cGVQaWN0dXJlIiwiZ2V0QXR0cmlidXRlIiwidGVtcGxhdGVQaWN0dXJlIiwicmVwbGFjZSIsInByb3RvdHlwZVZpZGVvIiwidGVtcGxhdGVWaWRlbyIsIm1vZGFsIiwib3Blbk1vZGFsIiwidGFyZ2V0Iiwic3R5bGUiLCJkaXNwbGF5IiwicmVtb3ZlQXR0cmlidXRlIiwiY2xvc2VNb2RhbCIsInN0b3BQcm9wYWdhdGlvbiIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJhIiwiYnRuRGVsZXRlUGljdHVyZSIsImJ0bkRlbGV0ZVZpZGVvIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLENBQUMsWUFBWTtBQUNULE1BQU1BLGdCQUFnQixHQUFHQyxRQUFRLENBQUNDLGNBQVQsQ0FBd0IsZ0JBQXhCLENBQXpCO0FBQ0EsTUFBTUMsY0FBYyxHQUFHRixRQUFRLENBQUNDLGNBQVQsQ0FBd0IsY0FBeEIs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QVFILEdBVEQ7QUFZSCxDQXhLRCxJIiwiZmlsZSI6ImpzL2VkaXQtdHJpY2suanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xyXG4gICAgY29uc3QgY29udGFpbmVyUGljdHVyZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0cmlja19waWN0dXJlcycpO1xyXG4gICAgY29uc3QgY29udGFpbmVyVmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHJpY2tfdmlkZW9zJyk7XHJcblxyXG4gICAgbGV0IGluZGV4UGljdHVyZSA9IGNvbnRhaW5lclBpY3R1cmUucXVlcnlTZWxlY3RvckFsbCgnLmVkaXQtdHJpY2stY29udGVudC1mb3JtLXJvdycpLmxlbmd0aDtcclxuICAgIGxldCBpbmRleFZpZGVvID0gY29udGFpbmVyVmlkZW8ucXVlcnlTZWxlY3RvckFsbCgnLmVkaXQtdHJpY2stY29udGVudC1mb3JtLXJvdycpLmxlbmd0aDtcclxuXHJcbiAgICBpZiAoaW5kZXhQaWN0dXJlID09IDApIHtcclxuICAgICAgICBhZGRQaWN0dXJlRm9ybShjb250YWluZXJQaWN0dXJlKTtcclxuICAgIH1cclxuICAgIGlmIChpbmRleFZpZGVvID09IDApIHtcclxuICAgICAgICBhZGRWaWRlb0Zvcm0oY29udGFpbmVyVmlkZW8pO1xyXG4gICAgfVxyXG4gICAgY29uc3QgY3JlYXRlTW9kYWxQaWN0dXJlID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc3QgYnRuID0gJzxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwianMtbW9kYWwtY2xvc2VcIj5YPC9idXR0b24+JztcclxuICAgICAgICBjb25zdCBmb3JtUm93ID0gY29udGFpbmVyUGljdHVyZS5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdC10cmljay1jb250ZW50LWZvcm0tcm93Jyk7XHJcbiAgICAgICAgY29uc3QgZWxNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1tb2RhbC1waWN0dXJlJyk7XHJcbiAgICAgICAgY29uc3QgbW9kYWxXcmFwcGVyID0gY29udGFpbmVyUGljdHVyZS5xdWVyeVNlbGVjdG9yQWxsKCcubW9kYWwtbm9uZScpO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZvcm1Sb3cubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgZm9ybVJvd1tpXS5jbGFzc0xpc3QuYWRkKCdtb2RhbCcpO1xyXG4gICAgICAgICAgICBmb3JtUm93W2ldLnNldEF0dHJpYnV0ZShcImlkXCIsIFwibW9kYWwtcGljdHVyZS1cIiArIGkpO1xyXG4gICAgICAgICAgICBmb3JtUm93W2ldLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICAgICAgZm9ybVJvd1tpXS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiZGlhbG9nXCIpO1xyXG4gICAgICAgICAgICBmb3JtUm93W2ldLnNldEF0dHJpYnV0ZShcImFyaWEtbW9kYWxcIiwgXCJmYWxzZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb2RhbFdyYXBwZXIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbW9kYWxXcmFwcGVyW2ldLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGJ0bik7XHJcbiAgICAgICAgICAgIG1vZGFsV3JhcHBlcltpXS5jbGFzc05hbWUgPSAnbW9kYWwtd3JhcHBlciBqcy1tb2RhbC1zdG9wJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbE1vZGFsLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGVsTW9kYWxbaV0uc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBcIiNtb2RhbC1waWN0dXJlLVwiICsgaSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuICAgIGNvbnN0IGNyZWF0ZU1vZGFsVmlkZW8gPSBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zdCBidG4gPSAnPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJqcy1tb2RhbC1jbG9zZVwiPlg8L2J1dHRvbj4nO1xyXG4gICAgICAgIGNvbnN0IGZvcm1Sb3cgPSBjb250YWluZXJWaWRlby5xdWVyeVNlbGVjdG9yQWxsKCcuZWRpdC10cmljay1jb250ZW50LWZvcm0tcm93Jyk7XHJcbiAgICAgICAgY29uc3QgZWxNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5qcy1tb2RhbC12aWRlbycpO1xyXG4gICAgICAgIGNvbnN0IG1vZGFsV3JhcHBlciA9IGNvbnRhaW5lclZpZGVvLnF1ZXJ5U2VsZWN0b3JBbGwoJy5tb2RhbC1ub25lJyk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZm9ybVJvdy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICBmb3JtUm93W2ldLmNsYXNzTGlzdC5hZGQoJ21vZGFsJyk7XHJcbiAgICAgICAgICAgIGZvcm1Sb3dbaV0uc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJtb2RhbC12aWRlby1cIiArIGkpO1xyXG4gICAgICAgICAgICBmb3JtUm93W2ldLnNldEF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICAgICAgZm9ybVJvd1tpXS5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiZGlhbG9nXCIpO1xyXG4gICAgICAgICAgICBmb3JtUm93W2ldLnNldEF0dHJpYnV0ZShcImFyaWEtbW9kYWxcIiwgXCJmYWxzZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtb2RhbFdyYXBwZXIubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgbW9kYWxXcmFwcGVyW2ldLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGJ0bik7XHJcbiAgICAgICAgICAgIG1vZGFsV3JhcHBlcltpXS5jbGFzc05hbWUgPSAnbW9kYWwtd3JhcHBlciBqcy1tb2RhbC1zdG9wJztcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbE1vZGFsLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGVsTW9kYWxbaV0uc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBcIiNtb2RhbC12aWRlby1cIiArIGkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcbiAgICBjcmVhdGVNb2RhbFBpY3R1cmUoKTtcclxuICAgIGNyZWF0ZU1vZGFsVmlkZW8oKTtcclxuXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuLWFkZC1waWN0dXJlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGFkZFBpY3R1cmVGb3JtKGNvbnRhaW5lclBpY3R1cmUpO1xyXG4gICAgfSlcclxuXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYnRuLWFkZC12aWRlbycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBhZGRWaWRlb0Zvcm0oY29udGFpbmVyVmlkZW8pO1xyXG4gICAgfSlcclxuXHJcbiAgICBmdW5jdGlvbiBhZGRSZW1vdmVCdG4oKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uLmJ0bi1kZWxldGUtcGljdHVyZS5mYXMuZmEtdHJhc2gtYWx0JykuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xyXG4gICAgICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbi5idG4tZGVsZXRlLXZpZGVvLmZhcy5mYS10cmFzaC1hbHQnKS5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcmVudE5vZGUucGFyZW50Tm9kZS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFBpY3R1cmVGb3JtKGNvbnRhaW5lclBpY3R1cmUpIHtcclxuICAgICAgICBjb25zdCBwcm90b3R5cGVQaWN0dXJlID0gY29udGFpbmVyUGljdHVyZS5nZXRBdHRyaWJ1dGUoJ2RhdGEtcHJvdG90eXBlJyk7XHJcbiAgICAgICAgY29uc3QgdGVtcGxhdGVQaWN0dXJlID0gcHJvdG90eXBlUGljdHVyZS5yZXBsYWNlKC9fX25hbWVfXy9nLCBpbmRleFBpY3R1cmUpO1xyXG4gICAgICAgIGNvbnRhaW5lclBpY3R1cmUuaW5zZXJ0QWRqYWNlbnRIVE1MKCdiZWZvcmVlbmQnLCB0ZW1wbGF0ZVBpY3R1cmUpO1xyXG4gICAgICAgIGluZGV4UGljdHVyZSsrO1xyXG4gICAgICAgIGFkZFJlbW92ZUJ0bigpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGFkZFZpZGVvRm9ybShjb250YWluZXJWaWRlbykge1xyXG4gICAgICAgIGNvbnN0IHByb3RvdHlwZVZpZGVvID0gY29udGFpbmVyVmlkZW8uZ2V0QXR0cmlidXRlKCdkYXRhLXByb3RvdHlwZScpO1xyXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlVmlkZW8gPSBwcm90b3R5cGVWaWRlby5yZXBsYWNlKC9fX25hbWVfXy9nLCBpbmRleFZpZGVvKTtcclxuICAgICAgICBjb250YWluZXJWaWRlby5pbnNlcnRBZGphY2VudEhUTUwoJ2JlZm9yZWVuZCcsIHRlbXBsYXRlVmlkZW8pO1xyXG4gICAgICAgIGluZGV4VmlkZW8rKztcclxuICAgICAgICBhZGRSZW1vdmVCdG4oKTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbW9kYWwgPSBudWxsO1xyXG4gICAgY29uc3Qgb3Blbk1vZGFsID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgIGxldCB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpKTtcclxuICAgICAgICB0YXJnZXQucXVlcnlTZWxlY3RvcignLmZhcy5mYS10cmFzaC1hbHQnKS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICAgICAgdGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICAgICAgdGFyZ2V0LnJlbW92ZUF0dHJpYnV0ZShcImFyaWEtaGlkZGVuXCIpO1xyXG4gICAgICAgIHRhcmdldC5zZXRBdHRyaWJ1dGUoXCJhcmlhLW1vZGFsXCIsIFwidHJ1ZVwiKTtcclxuICAgICAgICBtb2RhbCA9IHRhcmdldDtcclxuICAgICAgICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xyXG4gICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5qcy1tb2RhbC1jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XHJcbiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignLmpzLW1vZGFsLXN0b3AnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XHJcbiAgICB9XHJcbiAgICBjb25zdCBjbG9zZU1vZGFsID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKG1vZGFsID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxyXG4gICAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICBtb2RhbC5zZXRBdHRyaWJ1dGUoXCJhcmlhLWhpZGRlblwiLCBcInRydWVcIik7XHJcbiAgICAgICAgbW9kYWwucmVtb3ZlQXR0cmlidXRlKFwiYXJpYS1tb2RhbFwiKTtcclxuICAgICAgICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGNsb3NlTW9kYWwpO1xyXG4gICAgICAgIG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5qcy1tb2RhbC1jbG9zZScpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xvc2VNb2RhbCk7XHJcbiAgICAgICAgbW9kYWwucXVlcnlTZWxlY3RvcignLmpzLW1vZGFsLXN0b3AnKS5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHN0b3BQcm9wYWdhdGlvbik7XHJcbiAgICAgICAgbW9kYWwgPSBudWxsO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc3RvcFByb3BhZ2F0aW9uID0gZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuanMtbW9kYWwtcGljdHVyZScpLmZvckVhY2goYSA9PiB7XHJcbiAgICAgICAgYS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9wZW5Nb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmpzLW1vZGFsLXZpZGVvJykuZm9yRWFjaChhID0+IHtcclxuICAgICAgICBhLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb3Blbk1vZGFsKTtcclxuICAgIH0pXHJcbiAgICBjb25zdCBidG5EZWxldGVQaWN0dXJlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJ0bi1kZWxldGUtcGljdHVyZS5mYXMuZmEtdHJhc2gtYWx0Jyk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ0bkRlbGV0ZVBpY3R1cmUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBidG5EZWxldGVQaWN0dXJlW2ldLnNldEF0dHJpYnV0ZShcImhyZWZcIiwgXCIjbW9kYWwtcGljdHVyZS1cIiArIGkpO1xyXG4gICAgfVxyXG4gICAgY29uc3QgYnRuRGVsZXRlVmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYnRuLWRlbGV0ZS12aWRlby5mYXMuZmEtdHJhc2gtYWx0Jyk7XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJ0bkRlbGV0ZVZpZGVvLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgYnRuRGVsZXRlVmlkZW9baV0uc2V0QXR0cmlidXRlKFwiaHJlZlwiLCBcIiNtb2RhbC12aWRlby1cIiArIGkpO1xyXG4gICAgfVxyXG5cclxuICAgIGJ0bkRlbGV0ZVZpZGVvLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgICBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgIGxldCB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJocmVmXCIpKTtcclxuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgaWYodGFyZ2V0KSB7XHJcbiAgICAgICAgICAgICAgICB0YXJnZXQucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUucmVtb3ZlKCk7XHJcbiAgICAgICAgfSlcclxuICAgIH0pXHJcblxyXG4gICAgYnRuRGVsZXRlUGljdHVyZS5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICBsZXQgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKSk7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGlmKHRhcmdldCkge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHRoaXMucGFyZW50Tm9kZS5wYXJlbnROb2RlLnJlbW92ZSgpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9KVxyXG5cclxuXHJcbn0pKClcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==